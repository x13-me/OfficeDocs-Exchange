---
title: 'Configure anti-malware policies: Exchange 2013 Help'
TOCTitle: Configure anti-malware policies
ms:assetid: e16ac4a2-de5c-4723-8ab6-d9c7ef4ce1b4
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ150576(v=EXCHG.150)
ms:contentKeyID: 47560120
ms.date: 07/14/2017
mtps_version: v=EXCHG.150
---

# Configure anti-malware policies

 

_**Applies to:** Exchange Server 2013_


By default, malware filtering is enabled in Microsoft Exchange Server 2013. The default anti-malware policy controls your company-wide malware filtering settings. As an administrator, you can view and edit, but not delete, the default anti-malware policy so that it is tailored to best meet the needs of your organization. For greater granularity, you can also create custom malware filter policies and apply them to specified users, groups, or domains in your organization. Custom policies always take precedence over the default policy, but you can change the priority (that is, the running order) of your custom policies. For more information, see Use the EAC to configure the default anti-malware policy.

## What do you need to know before you begin?

  - We recommend that you manually download anti-malware engine and definition updates on your Exchange server prior to placing it in production. For more information, see [Download engine and definition updates](download-engine-and-definition-updates-exchange-2013-help.md).

  - You need to be assigned permissions before you can perform this procedure or procedures. To see what permissions you need, see the “Anti-malware” entry in the [Anti-spam and anti-malware permissions](anti-spam-and-anti-malware-permissions-exchange-2013-help.md) topic.

  - For information about keyboard shortcuts that may apply to the procedures in this topic, see [Keyboard shortcuts in the Exchange admin center](keyboard-shortcuts-in-the-exchange-admin-center-2013-help.md).


> [!TIP]
> Having problems? Ask for help in the Exchange forums. Visit the forums at <A href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</A>, <A href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</A>, or <A href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</A>.



## What do you want to do?

## Use the EAC to configure the default anti-malware policy

1.  In the Exchange admin center (EAC), navigate to **Protection** \> **Malware filter**.

2.  Do one of the following:
    
      - Double-click the default policy in order to edit this company-wide policy.
    
      - Click the ![Add Icon](images/JJ218640.c1e75329-d6d7-4073-a27d-498590bbb558(EXCHG.150).gif "Add Icon") **New** icon in order to create a new policy that can be applied to users, groups, and domains in your organization. You can also edit existing custom policies by double-clicking them.

3.  For custom policies only, specify a name for this policy. You can optionally specify a more detailed description as well. You cannot rename the default policy.
    

    > [!NOTE]
    > When creating a new policy, all configuration settings appear on a single screen, whereas when editing a policy you must navigate through different screens. The settings are the same in either case, but the rest of this procedure describes how to access these settings when editing a policy.



4.  Click the **Settings** menu option. In the **Malware Detection Response** section, use the option buttons to select the action to take when malware is detected in a message:
    
      - **Delete the entire message**   Prevents the entire message, including attachments, from being delivered to the intended recipients. This is the default value.
    
      - **Delete all attachments and use default alert text**   Deletes all message attachments, not just the infected one, and inserts the following default alert text into a text file that replaces the attachments: “Malware was detected in one or more attachments included with this email. All attachments have been deleted.”
    
      - **Delete all attachments and use custom alert text**   Deletes all message attachments, not just the infected one, and inserts a custom message into a text file that replaces the attachments. Selecting this option enables the **Custom alert text** field where you must type a custom message.
    

    > [!IMPORTANT]
    > If malware is detected in the message body, the entire message, including all attachments, will be deleted regardless of which option you select. This action is applied to both inbound and outbound messages.



5.  In the **Notifications** section, you have the option to send a notification email message to senders or administrators when a message is detected as malware and is not delivered. These notifications are only sent when the entire message is deleted.
    
    1.  In the **Sender Notifications** section, select the check boxes to **Notify internal senders** (those within your organization) or to **Notify external senders** (those outside your organization) when a detected message is not delivered.
    
    2.  Similarly, in the **Administrator Notifications** section, select the check boxes to **Notify administrator about undelivered messages from internal senders** or to **Notify administrator about undelivered messages from external senders**. Specify the email address or addresses of the administrator in their respective **Administrator email address** fields after selecting one or both of these check boxes.
        
        The default notification text is “This message was created automatically by mail delivery software. Your email message was not delivered to the intended recipients because malware was detected.” The language in which the default notification text is sent is dependent on the locale of the message being processed.
    
    3.  In the **Customize Notifications** section, you can create customized notification text to be used in place of the default notification text for sender and administrator notifications. Select the **Use customized notification text** check box, and then specify values in the following required fields:
        
          - **From name**   The name you want to be used as the sender of the customized notification.
        
          - **From address**   The email address you want to be used as the sender of the customized notification.
        
          - **Messages from internal senders**   The **Subject** and **Message** of the notification if the detected message originated from an internal sender.
        
          - **Messages from external senders**   The **Subject** and **Message** of the notification if the detected message originated from an external sender.
            

            > [!NOTE]
            > The default Subject text is “Undeliverable message.”

    
    4.  For custom policies only, click the **Apply to** menu item and then create a condition-based rule to specify the users, groups, and/or domains for whom to apply this policy. You can create multiple conditions provided that they are unique.
        
          - To select users, select **The recipient is**. In the subsequent dialog box, select one or more senders from your company from the user picker list and then click **add**. To add senders who aren’t on the list, type their email addresses and click **Check names**. In this box, you can also use wildcards for multiple email addresses (for example: \*@*domainname*). When you are done with your selections, click **ok** to return to the main screen.
        
          - To select groups, select **The recipient is a member of** and then, in the subsequent dialog box, select or specify the groups. Click **ok** to return to the main screen.
        
          - To select domains, select **The recipient domain is** and then, in the subsequent dialog box, add the domains. Click **ok** to return to the main screen.
        
        You can create exceptions within the rule, for example you can filter messages from all domains except for a certain domain. Click **add exception** and then create your exception conditions similar to the way you created the other conditions.
    
    5.  Click **Save**. A summary of your default policy settings appears in the right pane.


> [!TIP]
> <UL>
> <LI>
> <P>You can select or clear the check boxes in the <STRONG>ENABLED</STRONG> column to enable or disable your custom policies. All policies are enabled by default, and the default policy cannot be disabled.</P>
> <LI>
> <P>To delete a custom policy, select the policy, click the <IMG title="Delete icon" alt="Delete icon" src="images/Dd298078.14f639f6-61e8-4418-bbfb-0db14de9d2f5(EXCHG.150).gif"><STRONG>Delete</STRONG> icon, and then confirm that you want to delete the policy. The default policy cannot be deleted.</P>
> <LI>
> <P>Custom policies always take precedence over the default policy. Custom policies run in the reverse order that you created them (from oldest to newest), but you can change the priority (running order) of your custom policies by clicking the <IMG title="Up Arrow Icon" alt="Up Arrow Icon" src="images/JJ150576.1732c727-328b-4a1a-b84d-6d7252c7dcab(EXCHG.150).gif"> up arrow and <IMG title="Down Arrow Icon" alt="Down Arrow Icon" src="images/JJ150576.ef5ca57d-a033-457b-bd92-6361877c33d0(EXCHG.150).gif"> down arrow. The policy with a <STRONG>PRIORITY</STRONG> of <STRONG>0</STRONG> will run first, followed by <STRONG>1</STRONG>, then <STRONG>2</STRONG>, and so on.</P></LI></UL>



## How do you know this worked?

The following procedure provides instructions for using the EICAR.TXT antivirus test file to verify that malware filtering is working correctly.


> [!IMPORTANT]
> The EICAR.TXT file is not a virus. However, because users often have the need to test that installations function correctly, the antivirus industry, through the European Institute for Computer Antivirus Research, has adopted the EICAR standard in order to meet this need.



1.  Create a new text file, and then name the file EICAR.TXT.

2.  Copy the following line into the text file:
    
    ```powershell
        X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
    ```
    
    Make sure that this is the only string in the file. When done, you will have a 68-byte file.
    

    > [!NOTE]
    > If you are using a desktop antivirus program, make sure that the folder you are saving the file to is excluded from scanning.



3.  Attach this file to an email message that will be filtered by Exchange 2013.
    
    Check the recipient mailbox of the test message. Depending on the malware detection response you have configured, the entire message will be deleted, or the attachment will be deleted and replaced with the alert text file. Any configured notifications will also be distributed.

4.  Delete the EICAR.TXT file after testing is completed so that other users are not unnecessarily alarmed.

## For more information

[Anti-malware FAQ](anti-malware-faq-exchange-2013-help.md)

[Rescan messages already malware scanned by the hosted filtering service](rescan-messages-already-malware-scanned-by-the-hosted-filtering-service-exchange-2013-help.md)

[Disable or bypass anti-malware scanning](disable-or-bypass-anti-malware-scanning-exchange-2013-help.md)

